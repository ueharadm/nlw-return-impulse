import { useState } from "react";

import { FeedbackTypeStep } from "./Steps/FeedbackTypeStep";
import { FeedbackContentStep } from "./Steps/FeedbackContentStep";
import { FeedbackSuccessStep } from "./Steps/FeedbackSuccessStep";

export const feedbackTypes = {
  BUG: {
    title: "Problema",
    image: {
      source: <div className="w-6 h-6 flex-1 flex flex-col items-center"><svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M9.91669 6C10.9167 5 10.1667 2 8.47869 2C6.79069 2 6.91669 4 7.91669 4C8.91669 4 8.91669 6 8.91669 7C8.91669 8 9.91669 6 9.91669 6ZM5.73369 7.72C6.73369 6.72 5.98369 3.72 4.29569 3.72C2.60769 3.72 2.73369 5.72 3.73369 5.72C4.73369 5.72 4.73369 7.72 4.73369 8.72C4.73369 9.72 5.73369 7.72 5.73369 7.72Z" fill="#AA8DD8"/>
      <path d="M32.1087 34.856C32.2977 35.664 33.3357 37.136 34.1407 36.947C34.9467 36.757 35.2177 34.976 35.0287 34.17C34.8397 33.362 34.0307 32.863 33.2247 33.053C32.4197 33.243 31.9187 34.05 32.1087 34.856ZM26.6747 35.505C26.6777 36.335 27.3557 38.003 28.1837 38C29.0117 37.996 29.6777 36.323 29.6747 35.494C29.6717 34.665 28.9977 33.997 28.1697 33.999C27.3417 34.003 26.6717 34.676 26.6747 35.505ZM21.4037 33.059C21.0777 33.823 21.0387 35.622 21.7997 35.949C22.5627 36.273 23.8367 35.002 24.1627 34.239C24.4877 33.477 24.1347 32.596 23.3737 32.269C22.6117 31.944 21.7307 32.296 21.4037 33.059ZM16.3727 22.019C15.5607 22.191 14.0647 23.192 14.2337 24.002C14.4067 24.812 16.1787 25.126 16.9907 24.955C17.8017 24.784 18.3197 23.988 18.1507 23.178C17.9787 22.368 17.1857 21.848 16.3727 22.019ZM14.3357 17.019C13.5237 17.191 12.0277 18.192 12.1967 19.002C12.3697 19.812 14.1417 20.126 14.9537 19.955C15.7647 19.784 16.2827 18.988 16.1137 18.178C15.9417 17.368 15.1477 16.848 14.3357 17.019Z" fill="#744EAA"/>
      <path d="M29.7457 36C32.5767 36 34.6717 35.123 35.0117 34.973C37.2827 33.963 38.3047 31.304 37.2957 29.034C36.2967 26.784 33.6797 25.759 31.4237 26.72C31.2907 26.77 29.6307 27.369 28.0807 26.648C26.2297 25.787 25.0857 23.339 24.4527 21.439C24.3087 21.009 24.0677 20.165 23.7667 19.123C21.9007 12.652 20.9347 10.838 19.7837 9.30299C16.0727 4.35199 10.1917 4.00699 7.30068 4.58699C4.86368 5.07399 3.28268 7.44499 3.77068 9.88199C4.25868 12.32 6.63068 13.902 9.06668 13.412C9.22868 13.386 11.2707 13.106 12.4907 14.581C13.1337 15.868 14.5707 19.709 15.1207 21.615C15.4667 22.814 15.7497 23.786 15.9147 24.282C17.6877 29.599 20.5807 33.175 24.5177 34.911C26.3697 35.729 28.1717 36 29.7457 36Z" fill="#9266CC"/>
      <path d="M9.18372 8C9.736 8 10.1837 7.55228 10.1837 7C10.1837 6.44772 9.736 6 9.18372 6C8.63143 6 8.18372 6.44772 8.18372 7C8.18372 7.55228 8.63143 8 9.18372 8Z" fill="#202024"/>
      <path d="M33.4247 34.964C33.3357 34.964 33.2447 34.952 33.1557 34.928C32.6237 34.78 32.3117 34.229 32.4597 33.697C33.2167 30.975 31.6897 29.155 31.6747 29.137C31.3157 28.718 31.3627 28.086 31.7817 27.727C32.1997 27.368 32.8327 27.415 33.1917 27.834C33.2837 27.941 35.4257 30.494 34.3867 34.231C34.2647 34.674 33.8617 34.964 33.4247 34.964ZM26.2257 34.401C25.9807 34.401 25.7357 34.312 25.5417 34.131C25.1387 33.753 25.1177 33.12 25.4947 32.717C26.9797 31.13 26.9477 28.524 26.9467 28.497C26.9307 27.945 27.3657 27.485 27.9187 27.469C28.4607 27.464 28.9317 27.888 28.9467 28.441C28.9507 28.58 29.0197 31.878 26.9557 34.085C26.7587 34.295 26.4917 34.401 26.2257 34.401ZM17.6837 25.705C17.2037 25.705 16.7797 25.358 16.6987 24.868C16.6087 24.324 16.9767 23.808 17.5217 23.719C20.5957 23.209 22.2957 21.342 22.3127 21.323C22.6777 20.913 23.3107 20.874 23.7217 21.239C24.1337 21.604 24.1747 22.232 23.8127 22.645C23.7257 22.744 21.6567 25.06 17.8487 25.691C17.7927 25.701 17.7377 25.705 17.6837 25.705ZM20.6047 30.562C20.1797 30.562 19.7857 30.29 19.6507 29.864C19.4847 29.338 19.7767 28.775 20.3027 28.609C22.9957 27.756 24.1827 25.779 24.1947 25.759C24.4747 25.282 25.0867 25.122 25.5627 25.402C26.0397 25.681 26.1987 26.295 25.9197 26.77C25.8567 26.878 24.3247 29.433 20.9067 30.514C20.8057 30.547 20.7037 30.562 20.6047 30.562ZM15.9857 19.892C15.4897 19.892 15.0587 19.523 14.9947 19.017C14.9257 18.469 15.3137 17.969 15.8617 17.899C18.5507 17.559 20.5187 15.928 20.5377 15.911C20.9597 15.557 21.5907 15.608 21.9457 16.03C22.3017 16.451 22.2507 17.08 21.8307 17.437C21.7337 17.52 19.4107 19.466 16.1127 19.883C16.0697 19.889 16.0277 19.892 15.9857 19.892ZM14.1647 15.125C13.7397 15.125 13.3457 14.852 13.2107 14.424C13.0457 13.897 13.3377 13.336 13.8647 13.17C16.9947 12.187 18.1177 10.478 18.1637 10.406C18.4587 9.94397 19.0747 9.80097 19.5387 10.094C20.0037 10.386 20.1497 10.993 19.8627 11.46C19.8027 11.557 18.3567 13.856 14.4637 15.079C14.3647 15.11 14.2637 15.125 14.1647 15.125Z" fill="#744EAA"/>
      </svg></div>,
      alt: "Imagem de um inseto",
    },
  },
  IDEA: {
    title: "Ideia",
    image: {
      source: <div className="w-6 h-6 flex-1 flex flex-col items-center"><svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M31 13.92C31 20.359 26 21.359 26 27.36C26 30.458 22.877 30.719 20.5 30.719C18.447 30.719 13.914 29.94 13.914 27.358C13.914 21.36 9 20.36 9 13.92C9 7.889 14.285 3 20.083 3C25.883 3 31 7.889 31 13.92Z" fill="#FFD983"/>
      <path d="M24.167 35.36C24.167 36.188 21.933 37.86 20 37.86C18.067 37.86 15.833 36.188 15.833 35.36C15.833 34.532 18.066 34.86 20 34.86C21.933 34.86 24.167 34.532 24.167 35.36Z" fill="#CCD6DD"/>
      <path d="M24.707 13.153C24.316 12.762 23.684 12.762 23.293 13.153L20 16.446L16.707 13.153C16.316 12.762 15.684 12.762 15.293 13.153C14.902 13.544 14.902 14.176 15.293 14.567L19 18.274V28.86C19 29.413 19.448 29.86 20 29.86C20.552 29.86 21 29.413 21 28.86V18.274L24.707 14.567C25.098 14.176 25.098 13.544 24.707 13.153Z" fill="#FFCC4D"/>
      <path d="M26 33.86C26 34.964 25.104 35.86 24 35.86H16C14.896 35.86 14 34.964 14 33.86V27.86H26V33.86Z" fill="#99AAB5"/>
      <path d="M13.999 34.86C13.519 34.86 13.095 34.513 13.014 34.024C12.923 33.48 13.291 32.964 13.836 32.874L25.836 30.874C26.38 30.776 26.896 31.151 26.986 31.696C27.077 32.24 26.709 32.756 26.164 32.846L14.164 34.846C14.109 34.856 14.053 34.86 13.999 34.86ZM13.999 30.86C13.519 30.86 13.095 30.513 13.014 30.024C12.923 29.48 13.291 28.964 13.836 28.874L25.836 26.874C26.38 26.777 26.896 27.151 26.986 27.696C27.077 28.24 26.709 28.756 26.164 28.846L14.164 30.846C14.109 30.856 14.053 30.86 13.999 30.86Z" fill="#CCD6DD"/>
      </svg></div>,
      alt: "Imagem de uma lâmpada",
    },
  },
  OTHER: {
    title: "Outro",
    image: {
      source: <div className="w-6 h-6 flex-1 flex flex-col items-center"><svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M38 14.875C38 11.009 34.866 7.875 31 7.875C29.833 7.875 28.735 8.165 27.768 8.669C25.686 5.842 22.343 4 18.563 4C13.431 4 9.088 7.38 7.64 12.036C4.982 12.653 3 15.03 3 17.875C3 20.854 5.174 23.32 8.021 23.788C8.237 27.737 11.498 30.875 15.5 30.875C17.676 30.875 19.63 29.942 21 28.462C22.37 29.942 24.323 30.875 26.5 30.875C30.643 30.875 34 27.518 34 23.375C34 22.665 33.895 21.981 33.711 21.33C36.23 20.271 38 17.78 38 14.875Z" fill="#85C8F8"/>
      <path d="M7 36.875C8.65685 36.875 10 35.5319 10 33.875C10 32.2181 8.65685 30.875 7 30.875C5.34315 30.875 4 32.2181 4 33.875C4 35.5319 5.34315 36.875 7 36.875Z" fill="#85C8F8"/>
      </svg></div>,
      alt: "Imagem de um balão de pensamento",
    },
  },
};

export type FeedbackType = keyof typeof feedbackTypes;

export function WidgetForm() {
  const [feedbackType, setFeedbackType] = useState<FeedbackType | null>(null);
  const [feedbackSent, setFeedbackSent] = useState(false);

  function handleRestartFeedback() {
    setFeedbackSent(false);
    setFeedbackType(null);
  }

  return (
    <div className="bg-zinc-900 p-4 relative rounded-2xl mb-4 flex flex-col items-center shadow-lg w-[calc(100vw-2rem)] md:w-auto">
      {feedbackSent ? (
        <FeedbackSuccessStep onFeedbackRestartRequested={handleRestartFeedback} />
      ) : (
        <>
          {!feedbackType ? (
            <FeedbackTypeStep onFeedbackTypeChanged={setFeedbackType} />
          ) : (
            <FeedbackContentStep
              feedbackType={feedbackType}
              onFeedbackRestartRequested={handleRestartFeedback}
              onFeedbackSent={() => setFeedbackSent(true)}
            />
          )}
        </>
      )}

      <footer className="text-xs text-neutral-400">
        Feito com ♥ por{" "}
        <a
          className="underline underline-offset-2"
          href="https://www.linkedin.com/in/victoruehara/"
        >
          Uehara
        </a>
      </footer>
    </div>
  );
}
